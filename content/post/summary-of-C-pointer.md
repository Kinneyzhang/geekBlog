---
title: "深入理解C指针"
date: 2022-06-26
draft: false
categories: ["技术总结"]
tags: ["指针","C语言"]
---

指针和动态内存管理是C语言学习中的重点和难点，本篇主要总结自己对指针的理解，深入浅出，言简意赅。

# 指针的本质

用最简洁的话来描述指针的本质就是：一个存储了内存地址的变量。所以说指针变量和普通变量并没有本质的区别，只不过指针中存储的是一个内存地址，而普通变量存储的是具体的数值（其实内存地址也是个数值）。当然，如果仅仅是存值类型的差异，并不能给指针带来如此大的威力。指针厉害的地方在于，基于存储地址这一特性：指针可以访问存储的这个地址中的内容并修改；另外，可以通过给指针赋不同的地址来改变指针指向的变量。指针也支持四则，比较等运算，这也给它提供更丰富的作用。

这听起来没有什么了不起，毕竟知道了地址，支持查看和修改这个地址中的值，再理所当然了。没错，这就是计算机底层CPU和内存模型的工作方式，而C语言是最接近底层硬件的高级语言。所以说，C语言的精髓是指针，指针是C语言的一切。

# 指针的表示

定义一个指针变量就是在变量名前面加上一个"*"。

下面有一个详细的例子，相信看完对指针的理解会有一个质的提升。

    #include<stdio.h>
    #include<stdlib.h>

    int main () {
      int a = 2;
      int *ptr = &a;
      
      printf("a的地址是：%p\n", &a);
      printf("a的内容是：%d\n", a);
      printf("ptr指针的地址是：%p\n", &ptr); // 指针变量自己所在的地址
      printf("ptr指针的内容是：%p\n", ptr); // a的地址
      printf("ptr指针所指向的内容是：%d\n", *ptr); // 指针指向的a的值
      printf("----------\n");
      
      *ptr = 5; // 修改指针指向的变量a的值
      printf("修改值后，a的地址是：%p\n", &a);
      printf("修改值后，a的内容是：%d\n", a);
      printf("修改值后，ptr指针的地址是：%p\n", &ptr); // 指针变量自己所在的地址
      printf("修改值后，ptr指针的内容是：%p\n", ptr); // 指针的指向未变：还是a的地址
      printf("修改值后，ptr指针所指向的内容是：%d\n", *ptr); // 指针指向的a的值，此时被修改了
      printf("----------\n");
      
      int b = 3;
      ptr = &b; // 修改指针的指向为变量b
      printf("修改指向后，a的地址是：%p\n", &a); // 指针已经不指向a了
      printf("修改指向后，a的内容是：%d\n", a); // 指针已经不指向a了
      printf("修改指向后，b的地址是：%p\n", &b);
      printf("修改指向后，b的内容是：%d\n", b);
      printf("修改指向后，ptr指针的地址是：%p\n", &ptr); // 指针变量自己所在的地址，未修改
      printf("修改指向后，ptr指针的内容是：%p\n", ptr); // b的地址
      printf("修改指向后，ptr指针所指向的内容是：%d\n", *ptr); // 指针指向的b的值
      printf("----------\n");
    }

打印结果：

`text
a的地址是：0x30981757c
a的内容是：2
ptr指针的地址是：0x309817570
ptr指针的内容是：0x30981757c
ptr指针所指向的内容是：2
----------
修改值后，a的地址是：0x30981757c
修改值后，a的内容是：5
修改值后，ptr指针的地址是：0x309817570
修改值后，ptr指针的内容是：0x30981757c
修改值后，ptr指针所指向的内容是：5
----------
修改指向后，a的地址是：0x30981757c
修改指向后，a的内容是：5
修改指向后，b的地址是：0x30981756c
修改指向后，b的内容是：3
修改指向后，ptr指针的地址是：0x309817570
修改指向后，ptr指针的内容是：0x30981756c
修改指向后，ptr指针所指向的内容是：3
----------
`

# 常用的指针

# 指针和引用
